---
title: "cartography"
author: "Pierre Camilleri"
date: "25 mai 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(OpenStreetMap)
library(rgdal)
library(mongolite)
library(tibbletime)
library(ggiraph)

source('./tools/interface/connect_to_database.R')
```


```{r}
table_wholesample <- connect_to_database('algo1')
set.seed(150)
randCompanies <- table_wholesample %>% sample_n(20)

x = randCompanies$lattitude
y = randCompanies$longitude
```
```{r}
tweaked <- as.data.frame(projectMercator(x,y,drop=FALSE))
tweaked <- cbind(tweaked, randCompanies %>% select(siret))
```

```{r}
map <- openmap(c(min(x)-1,min(y)-1),c(max(x)+1,max(y)+1))
g <- autoplot(map,expand = FALSE, fill = "white")  +
geom_point_interactive(aes(x,y,tooltip = siret ), data=tweaked, color='red', size = 5, alpha=1)

#widgetframe::frameWidget(ggiraph(code=print(g)))
```

```{r}
ggiraph(code=print(g))
```

